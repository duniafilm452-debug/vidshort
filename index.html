<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Shortener Premium - Admin Panel</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-link"></i>
                    <h2>Link Shortener</h2>
                </div>
                <div class="version-badge">v2.0 Premium</div>
            </div>
            
            <nav class="sidebar-nav">
                <a href="#" class="nav-link active" data-page="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-link" data-page="create">
                    <i class="fas fa-plus-circle"></i>
                    <span>Buat Link Baru</span>
                </a>
                <a href="#" class="nav-link" data-page="links">
                    <i class="fas fa-list"></i>
                    <span>Daftar Link</span>
                </a>
                <a href="#" class="nav-link" data-page="categories">
                    <i class="fas fa-tags"></i>
                    <span>Kategori</span>
                </a>
                <a href="#" class="nav-link" data-page="stats">
                    <i class="fas fa-chart-bar"></i>
                    <span>Statistik</span>
                </a>
                <a href="#" class="nav-link" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <span>Pengaturan</span>
                </a>
            </nav>
            
            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <div class="user-details">
                        <h4>Administrator</h4>
                        <p>Super Admin</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Page -->
            <div class="page active" id="dashboardPage">
                <div class="page-header">
                    <h1><i class="fas fa-tachometer-alt"></i> Dashboard</h1>
                    <p>Ringkasan aktivitas link shortener Anda</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon gradient-blue">
                            <i class="fas fa-link"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalLinks">0</h3>
                            <p>Total Link</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon gradient-green">
                            <i class="fas fa-eye"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="totalClicks">0</h3>
                            <p>Total Klik</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon gradient-purple">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="uniqueVisitors">0</h3>
                            <p>Pengunjung Unik</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon gradient-orange">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="todayClicks">0</h3>
                            <p>Klik Hari Ini</p>
                        </div>
                    </div>
                </div>

                <div class="charts-row">
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-line"></i> Tren Klik 7 Hari Terakhir</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="clicksChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3><i class="fas fa-chart-pie"></i> Tipe Konten</h3>
                        </div>
                        <div class="chart-container">
                            <canvas id="contentTypeChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="recent-activity">
                    <div class="activity-header">
                        <h3><i class="fas fa-history"></i> Link Terbaru</h3>
                        <a href="#" onclick="showPage('links')" class="view-all">Lihat Semua <i class="fas fa-arrow-right"></i></a>
                    </div>
                    <div class="activity-list" id="recentLinks">
                        <div class="loading-state">
                            <div class="spinner"></div>
                            <p>Memuat data...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create Link Page -->
            <div class="page" id="createPage">
                <div class="page-header">
                    <h1><i class="fas fa-plus-circle"></i> Buat Link Baru</h1>
                    <p>Buat tautan pendek dengan berbagai tipe konten dan iklan</p>
                </div>

                <div class="create-card">
                    <div class="content-type-selector">
                        <h3><i class="fas fa-cubes"></i> Pilih Tipe Konten</h3>
                        <div class="type-grid">
                            <div class="type-item active" data-type="website">
                                <i class="fas fa-globe"></i>
                                <span>Website</span>
                            </div>
                            <div class="type-item" data-type="video">
                                <i class="fas fa-video"></i>
                                <span>Video</span>
                            </div>
                            <div class="type-item" data-type="image">
                                <i class="fas fa-image"></i>
                                <span>Gambar/Foto</span>
                            </div>
                            <div class="type-item" data-type="file">
                                <i class="fas fa-file"></i>
                                <span>File/Dokumen</span>
                            </div>
                            <div class="type-item" data-type="social">
                                <i class="fas fa-share-alt"></i>
                                <span>Social Media</span>
                            </div>
                            <div class="type-item" data-type="other">
                                <i class="fas fa-ellipsis-h"></i>
                                <span>Lainnya</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <div class="form-group">
                            <label>
                                <i class="fas fa-link"></i>
                                URL Tujuan
                                <span class="required">*</span>
                            </label>
                            <input type="url" id="destinationUrl" placeholder="https://contoh.com/video/foto/file" required>
                            <div class="url-preview" id="urlPreview">
                                <i class="fas fa-info-circle"></i>
                                <span id="urlTypeHint">Masukkan URL untuk melihat preview</span>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group half">
                                <label>
                                    <i class="fas fa-tag"></i>
                                    Judul Link
                                </label>
                                <input type="text" id="linkTitle" placeholder="Contoh: Video Tutorial">
                            </div>

                            <div class="form-group half">
                                <label>
                                    <i class="fas fa-i-cursor"></i>
                                    Custom Alias (Opsional)
                                </label>
                                <div class="custom-url-input">
                                    <span class="domain-prefix">/</span>
                                    <input type="text" id="customAlias" placeholder="nama-kustom">
                                </div>
                                <small class="form-hint">Kosongkan untuk generate otomatis</small>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-align-left"></i>
                                Deskripsi (Opsional)
                            </label>
                            <textarea id="linkDescription" rows="3" placeholder="Deskripsi singkat tentang link ini..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>
                                <i class="fas fa-folder"></i>
                                Kategori
                            </label>
                            <select id="linkCategory" class="category-select">
                                <option value="uncategorized">Tidak Berkategori</option>
                                <option value="video">Video</option>
                                <option value="tutorial">Tutorial</option>
                                <option value="download">Download</option>
                                <option value="gallery">Galeri</option>
                                <option value="social">Media Sosial</option>
                                <option value="other">Lainnya</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-ad"></i> Pengaturan Iklan</h3>
                        
                        <div class="ad-settings-grid">
                            <div class="ad-option">
                                <div class="ad-option-header">
                                    <i class="fas fa-clock"></i>
                                    <span>Countdown Timer</span>
                                </div>
                                <div class="ad-option-input">
                                    <input type="number" id="adTimer" value="10" min="5" max="30">
                                    <span>detik</span>
                                </div>
                            </div>

                            <div class="ad-option">
                                <div class="ad-option-header">
                                    <i class="fas fa-redo"></i>
                                    <span>Jumlah Iklan</span>
                                </div>
                                <div class="ad-option-input">
                                    <select id="adCount">
                                        <option value="1">1 Iklan</option>
                                        <option value="2" selected>2 Iklan</option>
                                        <option value="3">3 Iklan</option>
                                    </select>
                                </div>
                            </div>

                            <div class="ad-option">
                                <div class="ad-option-header">
                                    <i class="fas fa-mouse-pointer"></i>
                                    <span>Scroll Required</span>
                                </div>
                                <div class="ad-option-input">
                                    <label class="switch">
                                        <input type="checkbox" id="scrollRequired" checked>
                                        <span class="slider round"></span>
                                    </label>
                                    <span class="switch-label">Ya</span>
                                </div>
                            </div>

                            <div class="ad-option">
                                <div class="ad-option-header">
                                    <i class="fas fa-ban"></i>
                                    <span>Skip Ad</span>
                                </div>
                                <div class="ad-option-input">
                                    <label class="switch">
                                        <input type="checkbox" id="skipAd" checked>
                                        <span class="slider round"></span>
                                    </label>
                                    <span class="switch-label">Aktif</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-shield-alt"></i> Keamanan</h3>
                        
                        <div class="security-options">
                            <div class="security-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="passwordProtect">
                                    <span class="checkbox-custom"></span>
                                    Proteksi Password
                                </label>
                                <input type="password" id="linkPassword" class="password-input" placeholder="Masukkan password" disabled>
                            </div>

                            <div class="security-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="expiryDate">
                                    <span class="checkbox-custom"></span>
                                    Batas Waktu
                                </label>
                                <input type="datetime-local" id="linkExpiry" class="datetime-input" disabled>
                            </div>

                            <div class="security-item">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="maxClicks">
                                    <span class="checkbox-custom"></span>
                                    Batas Klik Maksimal
                                </label>
                                <input type="number" id="maxClicksInput" placeholder="1000" min="1" disabled>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button class="btn btn-secondary" id="testUrlBtn">
                            <i class="fas fa-flask"></i>
                            Test URL
                        </button>
                        <button class="btn btn-primary" id="createLinkBtn">
                            <i class="fas fa-magic"></i>
                            Buat Link Sekarang
                        </button>
                    </div>

                    <div class="preview-container" id="previewContainer">
                        <div class="preview-header">
                            <h4><i class="fas fa-external-link-alt"></i> Link Berhasil Dibuat!</h4>
                        </div>
                        <div class="link-preview">
                            <div class="link-info">
                                <div class="link-icon" id="previewIcon">
                                    <i class="fas fa-link"></i>
                                </div>
                                <div class="link-details">
                                    <h5 id="previewTitle">Judul Link</h5>
                                    <code id="previewCode">https://s.id/abcdef</code>
                                </div>
                            </div>
                            <div class="preview-stats">
                                <span><i class="fas fa-clock"></i> Iklan: <span id="previewAdTime">10</span> detik</span>
                                <span><i class="fas fa-shield-alt"></i> <span id="previewSecurity">Publik</span></span>
                            </div>
                        </div>
                        <div class="preview-actions">
                            <button class="btn btn-copy" id="copyPreviewBtn">
                                <i class="fas fa-copy"></i> Salin Link
                            </button>
                            <button class="btn btn-secondary" id="testLinkBtn">
                                <i class="fas fa-external-link-alt"></i> Test Link
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Links List Page -->
            <div class="page" id="linksPage">
                <div class="page-header">
                    <h1><i class="fas fa-list"></i> Daftar Link</h1>
                    <div class="header-actions">
                        <div class="filter-group">
                            <select id="typeFilter" class="filter-select">
                                <option value="all">Semua Tipe</option>
                                <option value="website">Website</option>
                                <option value="video">Video</option>
                                <option value="image">Gambar</option>
                                <option value="file">File</option>
                                <option value="social">Social Media</option>
                            </select>
                            <select id="categoryFilter" class="filter-select">
                                <option value="all">Semua Kategori</option>
                            </select>
                        </div>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchInput" placeholder="Cari link atau judul...">
                        </div>
                    </div>
                </div>

                <div class="links-grid" id="linksGrid">
                    <!-- Links will be loaded here -->
                </div>
            </div>

            <!-- Stats Page -->
            <div class="page" id="statsPage">
                <div class="page-header">
                    <h1><i class="fas fa-chart-line"></i> Statistik Detail</h1>
                    <div class="date-range">
                        <select id="statsRange" class="date-select">
                            <option value="7">7 Hari Terakhir</option>
                            <option value="30">30 Hari Terakhir</option>
                            <option value="90">3 Bulan</option>
                            <option value="365">1 Tahun</option>
                        </select>
                    </div>
                </div>

                <div class="stats-grid-detailed">
                    <div class="stats-card-large">
                        <h3><i class="fas fa-map-marker-alt"></i> Lokasi Pengunjung</h3>
                        <div id="locationStats" class="location-list">
                            <div class="loading-state">Memuat data...</div>
                        </div>
                    </div>

                    <div class="stats-card-large">
                        <h3><i class="fas fa-laptop"></i> Perangkat</h3>
                        <div id="deviceStats" class="device-list">
                            <div class="loading-state">Memuat data...</div>
                        </div>
                    </div>

                    <div class="stats-card-large">
                        <h3><i class="fas fa-external-link-alt"></i> Link Populer</h3>
                        <div id="popularLinks" class="popular-list">
                            <div class="loading-state">Memuat data...</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Categories Page -->
            <div class="page" id="categoriesPage">
                <div class="page-header">
                    <h1><i class="fas fa-tags"></i> Manajemen Kategori</h1>
                    <button class="btn btn-primary" id="addCategoryBtn">
                        <i class="fas fa-plus"></i> Tambah Kategori
                    </button>
                </div>

                <div class="categories-container">
                    <div class="categories-grid" id="categoriesGrid">
                        <!-- Categories will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div class="page" id="settingsPage">
                <div class="page-header">
                    <h1><i class="fas fa-cog"></i> Pengaturan</h1>
                </div>

                <div class="settings-grid">
                    <div class="settings-card">
                        <h3><i class="fas fa-ad"></i> Pengaturan Iklan Default</h3>
                        <div class="setting-item">
                            <label>Smartlink URL</label>
                            <input type="url" id="smartlinkUrl" placeholder="https://example.com/ad" value="https://www.effectivegatecpm.com/p43fdinys?key=7af8f475f3eda53e4d37ccfeaad8be18">
                        </div>
                        <div class="setting-item">
                            <label>Timer Default (detik)</label>
                            <input type="number" id="defaultTimer" value="10" min="5" max="30">
                        </div>
                        <div class="setting-item">
                            <label>Jumlah Iklan Default</label>
                            <select id="defaultAdCount">
                                <option value="1">1 Iklan</option>
                                <option value="2" selected>2 Iklan</option>
                                <option value="3">3 Iklan</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="saveAdSettings">
                            <i class="fas fa-save"></i> Simpan Pengaturan
                        </button>
                    </div>

                    <div class="settings-card">
                        <h3><i class="fas fa-globe"></i> Domain Kustom</h3>
                        <div class="setting-item">
                            <label>Domain</label>
                            <div class="domain-input">
                                <input type="text" placeholder="link.anda.com">
                                <button class="btn btn-secondary">Verifikasi</button>
                            </div>
                        </div>
                        <p class="setting-hint">Tambahkan domain kustom untuk link Anda</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div class="modal" id="successModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-check-circle"></i> Berhasil!</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="success-animation">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h4>Link berhasil dibuat!</h4>
                    <p>Salin link di bawah ini untuk dibagikan:</p>
                    
                    <div class="generated-link">
                        <input type="text" id="generatedLink" readonly>
                        <button class="btn btn-copy" id="copyLinkBtn">
                            <i class="fas fa-copy"></i> Salin
                        </button>
                    </div>
                    
                    <div class="link-stats-preview">
                        <div class="stat-item">
                            <i class="fas fa-clock"></i>
                            <span>Iklan: <span id="modalAdTime">10</span> detik</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-shield-alt"></i>
                            <span id="modalSecurity">Publik</span>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button class="btn btn-secondary" id="closeModalBtn">
                            <i class="fas fa-times"></i> Tutup
                        </button>
                        <button class="btn btn-primary" id="testGeneratedLink">
                            <i class="fas fa-external-link-alt"></i> Test Link
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="adminshortener.js"></script>
</body>
</html>